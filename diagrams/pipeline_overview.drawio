<mxfile host="Electron" modified="2023-05-16T18:20:43.476Z" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.2.8 Chrome/112.0.5615.165 Electron/24.2.0 Safari/537.36" etag="7K5TPjOltIorarvDsIE3" version="21.2.8" type="device">
  <diagram id="nO1Rkv5zXRL1NjKxyRtv" name="Page-1">
    <mxGraphModel dx="2440" dy="1414" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1700" pageHeight="1600" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="ham2sdyWAXaf4eXFICbt-1" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 32px;&quot;&gt;Supplementary Figure 1: High-level overview of scdrake pipelines and methods&lt;br style=&quot;font-size: 32px;&quot;&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#6666FF;fontSize=32;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="40" y="20" width="1280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-2" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Stage 01_input_qc&lt;/b&gt;&lt;br&gt;quality control, cell and gene filtering&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFEF0;strokeColor=#d6b656;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="40" y="270.5" width="260" height="854" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-3" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 24px;&quot;&gt;Single-sample pipeline&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#6666FF;fontSize=24;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="170" y="228.5" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-4" value="Input data (one of):&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- cellranger output&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- &lt;i&gt;SingleCellExperiment&lt;/i&gt; object&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- Feature-barcode matrix&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;(delimited table)&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=default;fillColor=#E6E6E6;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;spacingLeft=6;" parent="1" vertex="1">
          <mxGeometry x="123.75" y="321" width="149.25" height="98.86" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-5" value="" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;strokeWidth=1;align=center;outlineConnect=0;dashed=0;outlineConnect=0;shape=mxgraph.aws3d.file;aspect=fixed;strokeColor=#292929;" parent="1" vertex="1">
          <mxGeometry x="63" y="321" width="43.63" height="100" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Courier New;fontColor=#000000;startSize=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-6" target="ham2sdyWAXaf4eXFICbt-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-6" value="&lt;font color=&quot;#000000&quot;&gt;Read raw data.&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="63" y="441" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Courier New;fontColor=#000000;startSize=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-7" target="ham2sdyWAXaf4eXFICbt-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-7" value="&lt;font color=&quot;#000000&quot;&gt;Removal of empty droplets (optional).&lt;br&gt;&lt;font face=&quot;Courier New&quot;&gt;DropletUtils::emptyDrops()&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="63" y="491" width="210" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Courier New;fontColor=#000000;startSize=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-8" target="ham2sdyWAXaf4eXFICbt-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-8" value="&lt;font color=&quot;#000000&quot;&gt;Calculation of per-cell QC metrics, e.g. number of UMI and detected genes, or percentage of expressed mitochondrial genes.&lt;br&gt;&lt;font face=&quot;Courier New&quot;&gt;scater::perCellQCMetrics()&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="63" y="551" width="210" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Courier New;fontColor=#000000;startSize=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-9" target="ham2sdyWAXaf4eXFICbt-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-9" value="&lt;font color=&quot;#000000&quot;&gt;Calculation of boolean, QC metrics-based cell filters by two methods:&lt;br&gt;- Dataset sensitive (called &lt;i&gt;QC&lt;/i&gt;) filters: based on Median Average Deviation.&lt;br&gt;- Custom filters: based on user defined thresholds.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="63" y="651" width="210" height="100" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Courier New;fontColor=#000000;startSize=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-10" target="ham2sdyWAXaf4eXFICbt-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-10" value="&lt;font color=&quot;#000000&quot;&gt;Plots of QC metrics with visualization of differences between dataset-sensitive and custom filtering.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="63" y="921" width="210" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Courier New;fontColor=#000000;startSize=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-11" target="ham2sdyWAXaf4eXFICbt-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-11" value="&lt;font color=&quot;#000000&quot;&gt;Cell filtering separately for each filter (optional).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="63" y="771" width="210" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Courier New;fontColor=#000000;startSize=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-12" target="ham2sdyWAXaf4eXFICbt-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-12" value="&lt;font color=&quot;#000000&quot;&gt;Gene filtering (optional) based on minimum number of UMI per cell and minimum ratio of cells expressing a gene.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="63" y="831" width="210" height="70" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Courier New;fontColor=#000000;startSize=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-13" target="ham2sdyWAXaf4eXFICbt-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-13" value="&lt;font color=&quot;#000000&quot;&gt;Final selection of the filtered dataset, added gene annotation from organism database (e.g.&amp;nbsp;&lt;i&gt;org.Hs.eg.db).&lt;/i&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="63" y="991" width="210" height="70" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-14" value="&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;Visualization and HTML report.&lt;/span&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="63" y="1081" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-17" value="" style="endArrow=classic;html=1;rounded=0;fontFamily=Courier New;fontColor=#000000;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="84" y="411" as="sourcePoint" />
            <mxPoint x="84.32" y="441" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-26" value="&lt;b style=&quot;font-size: 14px;&quot;&gt;Stage 02_norm_clustering&lt;/b&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;normalization, highly variable genes selection, dimensionality reduction, cell clustering, cell type annotation, visualization&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFEF0;strokeColor=#d6b656;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="340" y="300" width="320" height="1160" as="geometry" />
        </mxCell>
        <mxCell id="viWicvidJHJeLeRqqGKH-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Courier New;" parent="1" source="ham2sdyWAXaf4eXFICbt-27" target="ham2sdyWAXaf4eXFICbt-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-27" value="&lt;font&gt;Calculation of cell cycle score and assignment of cells to phases (G1, G2M, S).&lt;br&gt;&lt;/font&gt;&lt;font face=&quot;Courier New&quot;&gt;Seurat::cc.genes.updated.2019&lt;br&gt;Seurat::CellCycleScoring()&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#000000;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="362" y="357" width="268" height="70" as="geometry" />
        </mxCell>
        <mxCell id="kHs4r68QSBqUsyetB1lQ-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-28" target="ham2sdyWAXaf4eXFICbt-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-28" value="&lt;font&gt;Normalization by either:&lt;br&gt;- Deconvolution:&lt;br&gt;&lt;/font&gt;&lt;font face=&quot;Courier New&quot;&gt;scran::computeSumFactors()&lt;/font&gt;&lt;br&gt;&lt;font face=&quot;Courier New&quot;&gt;scuttle::logNormCounts()&lt;/font&gt;&lt;br&gt;-&amp;nbsp;Regularized negative binomial regression:&lt;br&gt;&lt;font face=&quot;Courier New&quot;&gt;Seurat::SCTransform()&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#000000;fillColor=default;spacingLeft=6;spacingRight=2;align=left;sketch=0;shadow=0;glass=0;" parent="1" vertex="1">
          <mxGeometry x="362" y="447" width="268" height="100" as="geometry" />
        </mxCell>
        <mxCell id="kHs4r68QSBqUsyetB1lQ-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-29" target="ham2sdyWAXaf4eXFICbt-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-29" value="&lt;font&gt;Selection of HVGs by a selected metric (gene variance, coefficient of variation) and picking strategy (top N, thresholding on significance (FDR) or metric value). Optionally prior to HVG selection, detect and remove CC-related genes by their variance explained for CC phase. If normalization is performed by SCTransform, it automatically ranks genes and picks defined top N HVGs.&lt;br&gt;&lt;/font&gt;&lt;font face=&quot;Courier New&quot;&gt;scran::modelGeneVar()&lt;/font&gt;&lt;br&gt;&lt;font face=&quot;Courier New&quot;&gt;scran::modelGeneCV2&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#000000;fillColor=default;spacingLeft=6;spacingRight=2;align=left;arcSize=11;" parent="1" vertex="1">
          <mxGeometry x="362" y="568.5" width="268" height="180" as="geometry" />
        </mxCell>
        <mxCell id="kHs4r68QSBqUsyetB1lQ-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-30" target="ham2sdyWAXaf4eXFICbt-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-30" value="&lt;font&gt;Detection and removal of cell doublets (optional).&lt;br&gt;&lt;/font&gt;&lt;font face=&quot;Courier New&quot;&gt;scDblFinder::computeDoubletDensity()&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#000000;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="362" y="770.5" width="268" height="53.5" as="geometry" />
        </mxCell>
        <mxCell id="kHs4r68QSBqUsyetB1lQ-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-31" target="ham2sdyWAXaf4eXFICbt-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-31" value="&lt;font&gt;Calculation of PCA.&lt;br&gt;&lt;/font&gt;&lt;font face=&quot;Courier New&quot;&gt;scater::runPCA()&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#000000;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="362" y="845" width="268" height="35" as="geometry" />
        </mxCell>
        <mxCell id="kHs4r68QSBqUsyetB1lQ-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-32" target="ham2sdyWAXaf4eXFICbt-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-32" value="&lt;font&gt;Selection of top N PCs by variance explained for downstream usage (dimensionality reduction (UMAP, tSNE), clustering). Three different strategies for selection of PCs are used and visualized:&lt;br&gt;- Using the elbow point.&lt;br&gt;- Using the technical noise.&lt;br&gt;- Using the fixed number of PCs.&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#000000;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="362" y="900" width="268" height="130" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-33" value="&lt;div style=&quot;text-align: justify;&quot;&gt;Note: the pipeline implementation does not consist of linear workflow as depicted here - some parts are branched and can be automatically computed concurrently.&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;fontSize=18;fontFamily=Helvetica;fontColor=#000000;align=left;" parent="1" vertex="1">
          <mxGeometry x="40" y="70" width="440" height="110" as="geometry" />
        </mxCell>
        <mxCell id="kHs4r68QSBqUsyetB1lQ-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-34" target="ham2sdyWAXaf4eXFICbt-35" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-34" value="Cell clustering using:&lt;br&gt;-&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;Graph-based clustering (mutual nearest neighbors) using Louvain and Walktrap algorithms.&lt;br&gt;&lt;font face=&quot;Courier New&quot;&gt;scran::buildSNNGraph()&lt;br&gt;igraph::cluster_louvain()&lt;br&gt;igraph::cluster_walktrap()&lt;br&gt;igraph::cluster_leiden()&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div&gt;- K-means clustering using both custom numbers of K and best K selection.&lt;/div&gt;&lt;div&gt;- Single-Cell Consensus Clustering (SC3) with custom numbers of clusters.&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;SC3::sc3()&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#000000;fillColor=default;spacingLeft=6;spacingRight=2;align=left;arcSize=8;" parent="1" vertex="1">
          <mxGeometry x="362" y="1049.5" width="268" height="210.5" as="geometry" />
        </mxCell>
        <mxCell id="kHs4r68QSBqUsyetB1lQ-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ham2sdyWAXaf4eXFICbt-35" target="ham2sdyWAXaf4eXFICbt-36" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-35" value="&lt;font&gt;Cell type annotation (optional) using &lt;i&gt;celldex&lt;/i&gt; package-provided or custom reference datasets.&lt;br&gt;&lt;/font&gt;&lt;font face=&quot;Courier New&quot;&gt;SingleR::SingleR()&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#000000;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="362" y="1280" width="268" height="50" as="geometry" />
        </mxCell>
        <mxCell id="kHs4r68QSBqUsyetB1lQ-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-36" target="ham2sdyWAXaf4eXFICbt-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-36" value="&lt;font&gt;Dimensionality reduction by UMAP and tSNE.&lt;br&gt;&lt;/font&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;scater::runUMAP()&lt;/span&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;br&gt;scater::runTSNE()&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#000000;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="362" y="1350" width="268" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-37" value="&lt;font color=&quot;#000000&quot;&gt;Visualization and HTML report.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="362" y="1420" width="268" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-38" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Stage 01_integration&lt;/b&gt;&lt;br&gt;integration, dimensionality reduction&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#C7F4FF;strokeColor=#66E0FF;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="720" y="270.5" width="400" height="989.5" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-39" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 24px;&quot;&gt;Integration pipeline&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#6666FF;fontSize=24;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="775" y="228.5" width="290" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-40" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;Input data: multiple&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;background-color: initial;&quot; color=&quot;#6666ff&quot;&gt;sce_final_norm_clustering&lt;/font&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;targets (SCE) from the single-sample pipeline runs. Loaded either from drake caches or as Rds files (with e.g. additional cell data).&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=default;fillColor=#E6E6E6;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;spacingLeft=4;" parent="1" vertex="1">
          <mxGeometry x="810" y="331.23" width="286.88" height="79.54" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-42" value="" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;strokeWidth=1;align=center;outlineConnect=0;dashed=0;outlineConnect=0;shape=mxgraph.aws3d.file;aspect=fixed;strokeColor=#292929;" parent="1" vertex="1">
          <mxGeometry x="746.88" y="317" width="43.63" height="100" as="geometry" />
        </mxCell>
        <mxCell id="kHs4r68QSBqUsyetB1lQ-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ham2sdyWAXaf4eXFICbt-43" target="ham2sdyWAXaf4eXFICbt-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-43" value="&lt;font color=&quot;#000000&quot;&gt;Read datasets.&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="746.88" y="437" width="350" height="33.5" as="geometry" />
        </mxCell>
        <mxCell id="kHs4r68QSBqUsyetB1lQ-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-44" target="ham2sdyWAXaf4eXFICbt-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-44" value="&lt;font color=&quot;#000000&quot;&gt;Subset to common column (cell variables) and row data (genes), and metadata.&amp;nbsp;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="746.88" y="490.5" width="350" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ItrmpPHE8p6n0ieT8JwW-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-46" target="ham2sdyWAXaf4eXFICbt-47" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-46" value="&lt;font color=&quot;#000000&quot;&gt;Combine and select HVGs by either (and optionally remove CC-related genes prior to HVG selection):&lt;br&gt;- A HVG metric (gene variance or CV2), then apply top HVGs selection as in the single-sample pipeline.&lt;br&gt;&lt;font face=&quot;Courier New&quot;&gt;scran::combineVar()&lt;br&gt;scran::combineCV2()&lt;br&gt;&lt;/font&gt;- Set operations (without duplicates): intersection, union, or take them all.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;arcSize=11;" parent="1" vertex="1">
          <mxGeometry x="746.88" y="636.75" width="350" height="143.25" as="geometry" />
        </mxCell>
        <mxCell id="ItrmpPHE8p6n0ieT8JwW-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="ham2sdyWAXaf4eXFICbt-47" target="viWicvidJHJeLeRqqGKH-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-47" value="&lt;font color=&quot;#000000&quot;&gt;Perform integration by selected methods (and each separately for datasets with removed CC-related genes from HVGs, if enabled):&lt;br&gt;&lt;div&gt;- Rescaling: scale counts so that the average count within each batch is the same for each gene.&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;batchelor::rescaleBatches()&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;- Regression: fit a linear model to each gene regress out uninteresting factors of variation, returning a matrix of residuals.&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;batchelor::regressBatches()&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;- Fast mutual nearest neighbors.&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;batchelor::fastMNN()&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;- Harmony&lt;br&gt;&lt;font face=&quot;Courier New&quot;&gt;harmony::RunHarmony()&lt;/font&gt;&lt;/div&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;arcSize=7;" parent="1" vertex="1">
          <mxGeometry x="746.88" y="800" width="350" height="206" as="geometry" />
        </mxCell>
        <mxCell id="ItrmpPHE8p6n0ieT8JwW-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ham2sdyWAXaf4eXFICbt-48" target="ham2sdyWAXaf4eXFICbt-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ham2sdyWAXaf4eXFICbt-48" value="&lt;font color=&quot;#000000&quot;&gt;Normalization of each sample for inter-batch sequencing depth (later called as &quot;uncorrected&quot; integration method).&lt;br&gt;&lt;font face=&quot;Courier New&quot;&gt;batchelor::multiBatchNorm()&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="746.88" y="552" width="350" height="63.5" as="geometry" />
        </mxCell>
        <mxCell id="ItrmpPHE8p6n0ieT8JwW-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="viWicvidJHJeLeRqqGKH-3" target="viWicvidJHJeLeRqqGKH-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="viWicvidJHJeLeRqqGKH-3" value="&lt;font color=&quot;#000000&quot;&gt;For each integrated dataset with or without removed CC-related genes from HVGs (if enabled), perform the following:&lt;br&gt;- Calculate PCA and select number of PCs (same as in the 02_norm_clustering stage).&lt;br&gt;- Calculate reduced dimensions (UMAP, tSNE) (&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;same as in the 02_norm_clustering stage)&lt;/span&gt;&lt;font color=&quot;#000000&quot;&gt;.&lt;br&gt;- Mutual nearest neighbors (MNN) clustering to assess integration results.&lt;br&gt;- Calculate integration diagnostics (tables, plots, Rand indices).&lt;br&gt;&lt;font face=&quot;Courier New&quot;&gt;bluster::pairwiseRand()&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;arcSize=7;" parent="1" vertex="1">
          <mxGeometry x="746.88" y="1026" width="350" height="160" as="geometry" />
        </mxCell>
        <mxCell id="viWicvidJHJeLeRqqGKH-4" value="&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;Visualization and HTML report.&lt;/span&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="746.88" y="1209" width="350" height="30" as="geometry" />
        </mxCell>
        <mxCell id="viWicvidJHJeLeRqqGKH-5" value="&lt;b style=&quot;font-size: 14px;&quot;&gt;Stage 02_int_clustering&lt;/b&gt;&lt;br style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;cell clustering, cell type annotation, visualization&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#C7F4FF;strokeColor=#66E0FF;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="720" y="1280" width="400" height="277" as="geometry" />
        </mxCell>
        <mxCell id="ItrmpPHE8p6n0ieT8JwW-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="viWicvidJHJeLeRqqGKH-6" target="viWicvidJHJeLeRqqGKH-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="viWicvidJHJeLeRqqGKH-6" value="&lt;font color=&quot;#000000&quot;&gt;Select the final integrated dataset. This is upon the user preference, i.e. the integration method and whether CC-related genes were removed from HVGs (if enabled previously).&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="746" y="1333.73" width="350" height="69.27" as="geometry" />
        </mxCell>
        <mxCell id="ItrmpPHE8p6n0ieT8JwW-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="viWicvidJHJeLeRqqGKH-7" target="viWicvidJHJeLeRqqGKH-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="viWicvidJHJeLeRqqGKH-7" value="&lt;font color=&quot;#000000&quot;&gt;Perform the same procedures as in the 02_norm_clustering stage:&lt;br&gt;- Cell clustering.&lt;br&gt;- Cell type annotation.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="746" y="1425.48" width="350" height="66.52" as="geometry" />
        </mxCell>
        <mxCell id="viWicvidJHJeLeRqqGKH-8" value="&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;Visualization and HTML report.&lt;/span&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="746" y="1513.5" width="350" height="30" as="geometry" />
        </mxCell>
        <mxCell id="kHs4r68QSBqUsyetB1lQ-9" value="" style="endArrow=classic;html=1;rounded=0;fontFamily=Courier New;fontColor=#000000;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="768.2" y="407" as="sourcePoint" />
            <mxPoint x="768.52" y="437" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-1" value="&lt;font color=&quot;#000000&quot; style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 24px;&quot;&gt;Common pipelines&lt;/font&gt;&lt;br&gt;&lt;span style=&quot;font-size: 16px; font-weight: normal;&quot;&gt;stages common to both single-sample and integration pipelines&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#6666FF;fontSize=20;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="1180" y="220" width="450" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-2" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Stage cluster_markers&lt;/b&gt;&lt;br&gt;identify global cluster marker genes, i.e. genes that drive the separation of each cell cluster&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFD1F0;strokeColor=#FF52C5;verticalAlign=top;spacingLeft=5;" parent="1" vertex="1">
          <mxGeometry x="1180" y="270.5" width="450" height="332" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-3" value="" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;strokeColor=default;fontSize=12;fontColor=#000000;fillColor=#DBF7D9;arcSize=8;" parent="1" vertex="1">
          <mxGeometry x="570" y="70" width="230" height="120" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-4" value="&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;SCE = &lt;/span&gt;&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;&lt;i&gt;SingleCellExperiment&lt;/i&gt;&lt;/span&gt;&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt; object&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;CC = cell cycle&lt;br&gt;HVG = highly variable gene&lt;br&gt;PC = principal component&lt;br&gt;dimred = DIMensionality REDuction&lt;br&gt;&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;fontSize=12;strokeColor=default;fillColor=#C7D8FF;labelBackgroundColor=none;fontColor=default;verticalAlign=middle;horizontal=1;align=left;spacingLeft=4;" parent="1" vertex="1">
          <mxGeometry x="581" y="100" width="208" height="80" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-6" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 20px;&quot;&gt;Abbreviations&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#6666FF;fontSize=20;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="570" y="70" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Courier New;fontSize=24;" parent="1" source="jf8yFdJj5HJkme6PNDb0-15" target="jf8yFdJj5HJkme6PNDb0-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-15" value="&lt;font color=&quot;#000000&quot;&gt;Calculate statistical tests.&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;The user can define in which categorical variables (clusters, CC phases etc.) to search for markers. For each variable,&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(0, 0, 0); background-color: initial;&quot;&gt;three different tests (Student&#39;s t, Wilcoxon, binomial) are calculated for each pairwise comparison of the variable levels. For example, for k-means clustering with k = 3 we have three pairwise comparisons (1 vs. 2, 1 vs. 3, 2 vs. 3) and three different tests for each of them.&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;font face=&quot;Courier New&quot;&gt;scran::findMarkers()&lt;/font&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;arcSize=9;" parent="1" vertex="1">
          <mxGeometry x="1205" y="338.5" width="405" height="130" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Courier New;fontSize=24;" parent="1" source="jf8yFdJj5HJkme6PNDb0-16" target="jf8yFdJj5HJkme6PNDb0-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-16" value="&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;For each pairwise test, generate a HTML table with marker statistics, and a heatmap of top N markers and a summary plot for each of them.&lt;br&gt;&lt;/font&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;arcSize=28;" parent="1" vertex="1">
          <mxGeometry x="1205" y="488.25" width="405" height="51.5" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-17" value="&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;Visualization and HTML report.&lt;/span&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="1205" y="558.5" width="405" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-20" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Stage contrasts&lt;/b&gt;&lt;br&gt;differential gene expression between cell clusters&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFD1F0;strokeColor=#FF52C5;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="1180" y="636.75" width="450" height="258" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Courier New;fontSize=24;" parent="1" source="jf8yFdJj5HJkme6PNDb0-21" target="jf8yFdJj5HJkme6PNDb0-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-21" value="&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;Calculate statistical tests. The contrasts stage is very similar to the cluster_markers stage, except all outputs (heatmaps, tables) are related to individual pairwise comparisons.&lt;/font&gt;&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;font face=&quot;Courier New&quot;&gt;scran::findMarkers()&lt;/font&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;arcSize=9;" parent="1" vertex="1">
          <mxGeometry x="1205" y="688.5" width="405" height="70" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Courier New;fontSize=24;" parent="1" source="jf8yFdJj5HJkme6PNDb0-22" target="jf8yFdJj5HJkme6PNDb0-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-22" value="&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font color=&quot;#000000&quot;&gt;For each contrast and statistical test, generate a HTML table with marker statistics, and a heatmap of top N markers and a summary plot for each of them.&lt;br&gt;&lt;/font&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;arcSize=28;" parent="1" vertex="1">
          <mxGeometry x="1205" y="779.5" width="405" height="51.5" as="geometry" />
        </mxCell>
        <mxCell id="jf8yFdJj5HJkme6PNDb0-23" value="&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;Visualization and HTML report.&lt;/span&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=6;spacingRight=2;align=left;" parent="1" vertex="1">
          <mxGeometry x="1205" y="851" width="405" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
