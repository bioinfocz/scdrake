<mxfile host="Electron" modified="2023-05-16T18:23:02.801Z" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.2.8 Chrome/112.0.5615.165 Electron/24.2.0 Safari/537.36" etag="_HHx7PTH4YSQqCm_Z8py" version="21.2.8" type="device">
  <diagram id="kRLNOENncRnmhNmGzl1d" name="Page-1">
    <mxGraphModel dx="2074" dy="1202" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="2000" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="OYucTifmdRN6tnTj4TT2-88" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Stage 02_int_clustering&lt;/b&gt;&lt;br&gt;cell clustering, cell type annotation, visualization&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#C7F4FF;strokeColor=#66E0FF;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="590" y="1030" width="470" height="570" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-51" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Stage 02_norm_clustering&lt;/b&gt;&lt;br&gt;normalization, highly variable genes selection, dimensionality reduction, cell clustering, cell type annotation, visualization&lt;br&gt;&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFEF0;strokeColor=#d6b656;verticalAlign=top;spacingLeft=20;" parent="1" vertex="1">
          <mxGeometry x="40" y="1030" width="490" height="910" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-42" value="" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;strokeColor=default;fontSize=12;fontColor=#000000;fillColor=#DBF7D9;arcSize=6;" parent="1" vertex="1">
          <mxGeometry x="1660" y="52" width="280" height="330" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-1" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Stage 01_input_qc&lt;/b&gt;&lt;br&gt;quality control, cell and gene filtering&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFEF0;strokeColor=#d6b656;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="40" y="120" width="490" height="870" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-7" value="Input data (one of):&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- cellranger output&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- &lt;i&gt;SingleCellExperiment&lt;/i&gt; object (as a Rds file&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;or from a drake cache)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- Feature-barcode matrix&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;(delimited table)&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=default;fillColor=#E6E6E6;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;spacingLeft=4;" parent="1" vertex="1">
          <mxGeometry x="156.76" y="170" width="241.25" height="80" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="nj5r_WVCg5K1WdDVYo4t-8" target="nj5r_WVCg5K1WdDVYo4t-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.465;entryY=-0.004;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="nj5r_WVCg5K1WdDVYo4t-8" target="nj5r_WVCg5K1WdDVYo4t-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-8" value="sce_raw&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="285" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-10" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 24px;&quot;&gt;Single-sample pipeline&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#6666FF;fontSize=24;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="40" y="80.6" width="490" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-11" value="&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;SCE = &lt;/span&gt;&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;&lt;i&gt;SingleCellExperiment&lt;/i&gt;&lt;/span&gt;&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt; object&lt;br&gt;DF = &lt;/span&gt;&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;&lt;i&gt;DataFrame&lt;/i&gt;&lt;/span&gt;&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt; object&lt;br&gt;df = &lt;/span&gt;&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;&lt;i&gt;data.frame&lt;/i&gt;&lt;/span&gt;&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt; or &lt;/span&gt;&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;&lt;i&gt;tibble&lt;/i&gt;&lt;/span&gt;&lt;span style=&quot;font-family: Helvetica; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt; object&lt;br&gt;&lt;i style=&quot;text-align: center;&quot;&gt;colData()&lt;/i&gt;&lt;span style=&quot;text-align: center;&quot;&gt;&amp;nbsp;= cell (column) data&lt;br&gt;&lt;/span&gt;&lt;i&gt;rowData()&lt;/i&gt; = gene (row) data&lt;br&gt;CC = cell cycle&lt;br&gt;HVG = highly variable gene&lt;br&gt;PC = principal component&lt;br&gt;dimred = DIMensionality REDuction&lt;br&gt;&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;fontSize=12;strokeColor=default;fillColor=#C7D8FF;labelBackgroundColor=none;fontColor=default;verticalAlign=middle;horizontal=1;align=left;spacingLeft=4;" parent="1" vertex="1">
          <mxGeometry x="1688" y="231.54" width="224" height="139.46" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-12" value="&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;Supplementary Figure 2:&amp;nbsp;&lt;/span&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 32px;&quot;&gt;Low-level diagram of scdrake pipelines&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#6666FF;fontSize=32;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="40" y="20" width="1220" height="32" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-13" value="target name&lt;font color=&quot;#000000&quot;&gt; (object type)&lt;br&gt;optional description&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="1725" y="96.5" width="150" height="45" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-14" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 24px;&quot;&gt;Legend&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#6666FF;fontSize=24;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="1690" y="59" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="nj5r_WVCg5K1WdDVYo4t-15" target="nj5r_WVCg5K1WdDVYo4t-18" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="398" y="360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-15" value="empty_droplets&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp;(DF)&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;Statistics from DropletUtils::emptyDrops() (optional)&lt;/span&gt;&lt;/div&gt;&lt;/font&gt;" style="rounded=1;html=1;fontColor=#6666FF;fillColor=default;whiteSpace=wrap;spacing=2;spacingLeft=0;align=center;" parent="1" vertex="1">
          <mxGeometry x="305" y="270" width="185" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.138;entryY=-0.013;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;" parent="1" source="nj5r_WVCg5K1WdDVYo4t-18" target="nj5r_WVCg5K1WdDVYo4t-25" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="96" y="410" />
              <mxPoint x="96" y="410" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-18" value="sce_valid_cells&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;Removed empty droplets if enabled.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="335" width="130" height="50" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.501;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="nj5r_WVCg5K1WdDVYo4t-25" target="XZVlYNRyt7zDqL23juJK-1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="290" y="520" />
              <mxPoint x="290" y="520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="1" source="nj5r_WVCg5K1WdDVYo4t-25" target="XZVlYNRyt7zDqL23juJK-7" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="198" y="550" />
              <mxPoint x="398" y="550" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.47;entryY=-0.029;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;" parent="1" source="nj5r_WVCg5K1WdDVYo4t-25" target="XZVlYNRyt7zDqL23juJK-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="151" y="560" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-25" value="sce_unfiltered&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;&lt;i&gt;colData()&lt;/i&gt;&amp;nbsp;extended by QC metrics and boolean filters.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="492.5" width="165" height="55" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-28" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- Calculation of per-cell QC metrics (total number of UMI, % mitochondrial genes, etc.).&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- Assembly of two cell filters based on QC metrics: by predefined thresholds (&lt;/span&gt;&lt;i style=&quot;background-color: initial;&quot;&gt;custom filters&lt;/i&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;) and by Median Average Deviation (&lt;/span&gt;&lt;i style=&quot;background-color: initial;&quot;&gt;QC filters&lt;/i&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;).&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=default;fillColor=#E6E6E6;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;spacingLeft=4;" parent="1" vertex="1">
          <mxGeometry x="117.38" y="400" width="320" height="80" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-32" value="" style="endArrow=classic;html=1;rounded=0;fontSize=24;fontColor=#000000;jumpStyle=none;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1701" y="167" as="sourcePoint" />
            <mxPoint x="1756" y="167" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-34" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;target B depends on target A&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=none;fontSize=12;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1786" y="151.6" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-36" value="A" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;strokeColor=default;fontSize=12;fontColor=#000000;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="1676" y="157" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-37" value="B" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;strokeColor=default;fontSize=12;fontColor=#000000;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="1760" y="157" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-38" value="" style="endArrow=classic;html=1;rounded=0;fontSize=24;fontColor=#000000;jumpStyle=none;dashed=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1701" y="207.3" as="sourcePoint" />
            <mxPoint x="1756" y="207.3" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-39" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;target B has also multiple,&lt;br&gt;not shown dependencies&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=none;fontSize=12;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="1786" y="191.3" width="144" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-40" value="A" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;strokeColor=default;fontSize=12;fontColor=#000000;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="1676" y="197" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="nj5r_WVCg5K1WdDVYo4t-41" value="B" style="rounded=1;whiteSpace=wrap;html=1;labelBackgroundColor=none;strokeColor=default;fontSize=12;fontColor=#000000;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="1760" y="197" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-1" value="sce_unfiltered_plotlist&lt;font color=&quot;#000000&quot;&gt; (list)&lt;br&gt;Plots of QC metrics.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="305" y="500" width="185" height="40" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="XZVlYNRyt7zDqL23juJK-3" target="XZVlYNRyt7zDqL23juJK-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-3" value="sce_qc_gene_filter&lt;font color=&quot;#000000&quot;&gt; (logical)&lt;br&gt;Boolean filter for genes (TRUE = discard).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="645" width="165" height="50" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="XZVlYNRyt7zDqL23juJK-5" target="XZVlYNRyt7zDqL23juJK-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_7ywalsgCx7BF0AgiLHg-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="XZVlYNRyt7zDqL23juJK-5" target="XZVlYNRyt7zDqL23juJK-26" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="50" y="590.0000000000001" />
              <mxPoint x="50" y="762" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-5" value="sce_qc_filter&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;Filtered by QC filters (MAD).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="572.5" width="165" height="35" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="XZVlYNRyt7zDqL23juJK-7" target="XZVlYNRyt7zDqL23juJK-30" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="510" y="590" />
              <mxPoint x="510" y="770" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="XZVlYNRyt7zDqL23juJK-7" target="XZVlYNRyt7zDqL23juJK-10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="398" y="630" />
              <mxPoint x="398" y="630" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-7" value="sce_custom_filter&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;Filtered by custom filters (thresholds).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="305" y="565" width="185" height="50" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="XZVlYNRyt7zDqL23juJK-10" target="XZVlYNRyt7zDqL23juJK-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-10" value="sce_custom_gene_filter&lt;font color=&quot;#000000&quot;&gt; (logical)&lt;br&gt;Boolean filter for genes&lt;br&gt;(TRUE = discard).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="305" y="645" width="185" height="50" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-18" value="" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;strokeWidth=1;align=center;outlineConnect=0;dashed=0;outlineConnect=0;shape=mxgraph.aws3d.file;aspect=fixed;strokeColor=#292929;" parent="1" vertex="1">
          <mxGeometry x="100" y="170.00000000000003" width="40" height="91.68" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-19" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="110" y="245" as="sourcePoint" />
            <mxPoint x="109.70999999999998" y="285" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.402;entryY=-0.006;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-26" target="XZVlYNRyt7zDqL23juJK-35" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-26" value="sce_qc_filter_genes&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;Filtered by QC filters (MAD) and gene filter.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="735" width="165" height="55" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-30" target="XZVlYNRyt7zDqL23juJK-35" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="260" y="765" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-30" value="sce_custom_filter_genes&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;Filtered by custom filters (thresholds) and gene filter.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="305" y="740" width="185" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;" parent="1" source="XZVlYNRyt7zDqL23juJK-35" target="XZVlYNRyt7zDqL23juJK-52" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="175" y="1010" />
              <mxPoint x="48" y="1010" />
              <mxPoint x="48" y="1238" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=-0.004;entryY=0.582;entryDx=0;entryDy=0;strokeWidth=2;endArrow=classic;endFill=1;entryPerimeter=0;" parent="1" source="XZVlYNRyt7zDqL23juJK-35" target="XZVlYNRyt7zDqL23juJK-63" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="175" y="1010" />
              <mxPoint x="48" y="1010" />
              <mxPoint x="48" y="1147" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-35" value="sce_final_input_qc&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;The final SCE object of this stage. Either based on &lt;/font&gt;sce_qc_filter_genes&lt;font color=&quot;#000000&quot;&gt; or &lt;/font&gt;sce_custom_filter_genes&lt;font color=&quot;#000000&quot;&gt; (depends on config). Added gene annotation to &lt;i&gt;rowData()&lt;/i&gt;.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="855" width="205" height="100" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-41" value="report_input_qc&lt;font color=&quot;#000000&quot;&gt; (file)&lt;br&gt;HTML report for this stage.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=#FFE5F3;" parent="1" vertex="1">
          <mxGeometry x="330.5" y="915" width="158" height="40" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-45" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;fillColor=#FFE5F3;rotation=-110;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="391.45" y="749.06" width="20" height="207.54" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=1;endArrow=classic;endFill=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-52" target="XZVlYNRyt7zDqL23juJK-54" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-52" value="sce_norm&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;Normalized data by either &lt;i&gt;scran&lt;/i&gt;&amp;nbsp;or &lt;i&gt;SCTransform&lt;/i&gt;&amp;nbsp;(&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;can be skipped). Added cell cycle phases to &lt;i&gt;colData()&lt;/i&gt;.&lt;/span&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="1208" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;endArrow=classic;endFill=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-54" target="XZVlYNRyt7zDqL23juJK-61" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-54" value="sce_norm_hvg&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Added HVGs. Different strategies for their selection can be used. Optionally, cell cycle-related genes can be removed prior to HVG selection.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="1298" width="210" height="90" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;endArrow=classic;endFill=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-61" target="XZVlYNRyt7zDqL23juJK-67" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-38" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=1;endArrow=classic;endFill=1;dashed=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-61" target="OYucTifmdRN6tnTj4TT2-37" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="328" y="1438" />
              <mxPoint x="328" y="1344" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-46" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=1;endArrow=classic;endFill=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-61" target="OYucTifmdRN6tnTj4TT2-44" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="298" y="1425" />
              <mxPoint x="298" y="1249" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-61" value="sce_rm_doublets&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Removed doublets (optional). Added doublet score to &lt;i&gt;colData()&lt;/i&gt;.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="1413" width="210" height="50" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=1;endArrow=classic;endFill=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-63" target="XZVlYNRyt7zDqL23juJK-52" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-63" value="cc_genes&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Dataframe of annotated cell cycle genes taken from &lt;i&gt;Seurat::cc.genes.updated.2019&lt;/i&gt;&amp;nbsp;and present in the SCE.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="1100" width="210" height="80" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;endArrow=classic;endFill=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-67" target="XZVlYNRyt7zDqL23juJK-72" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-39" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.75;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;endArrow=classic;endFill=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-67" target="XZVlYNRyt7zDqL23juJK-69" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="328" y="1513" />
              <mxPoint x="328" y="1491" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-67" value="sce_pca&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;PCA computed and added to &lt;i&gt;reducedDims()&lt;/i&gt;.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="1488" width="210" height="50" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-69" value="pca_selected_pcs_plot&lt;font color=&quot;#000000&quot;&gt; (ggplot)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;A plot showing variance explained by principal components and thresholds/strategies to select their optimal number for downstream usage.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="344" y="1400" width="160" height="122" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=1;endArrow=classic;endFill=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-72" target="XZVlYNRyt7zDqL23juJK-74" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-72" value="sce_pca_selected_pcs&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;PCA subsetted to selected number of PCs. Multiple selection strategies are available.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="1563" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;endArrow=classic;endFill=1;" parent="1" source="XZVlYNRyt7zDqL23juJK-74" target="OYucTifmdRN6tnTj4TT2-41" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XZVlYNRyt7zDqL23juJK-74" value="sce_dimred&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Computed UMAP and tSNE, added to &lt;i&gt;reducedDims()&lt;/i&gt;.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="1647" width="210" height="50" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-24" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;entryX=0.518;entryY=-0.032;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="XZVlYNRyt7zDqL23juJK-45" target="XZVlYNRyt7zDqL23juJK-41" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="376.36" y="864" as="sourcePoint" />
            <mxPoint x="376.36" y="914" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;strokeWidth=1;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-37" target="OYucTifmdRN6tnTj4TT2-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_7ywalsgCx7BF0AgiLHg-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1.001;entryY=0.588;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-37" target="OYucTifmdRN6tnTj4TT2-41" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="310" y="1360" />
              <mxPoint x="310" y="1773" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-37" value="cell_annotation&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Cell annotation statistics using defined reference datasets (optional).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="348" y="1312.75" width="160" height="63" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=1;endArrow=classic;endFill=1;dashed=1;" parent="1" target="OYucTifmdRN6tnTj4TT2-47" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="273" y="1750" />
              <mxPoint x="290" y="1750" />
              <mxPoint x="290" y="1674" />
            </Array>
            <mxPoint x="270" y="1750" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-79" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.001;entryY=0.862;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;strokeWidth=1;fontColor=#000000;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-41" target="OYucTifmdRN6tnTj4TT2-48" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="288" y="1796" />
              <mxPoint x="288" y="1796" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-80" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;fontColor=#000000;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-41" target="OYucTifmdRN6tnTj4TT2-78" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="290" y="1750" />
              <mxPoint x="290" y="1584" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-41" value="sce_final_norm_clustering&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;The final SCE object of this stage. Contains: reduced dimensions, cell clusters (graph-based, k-means, SC3), cell annotation (optional), all other cell data (including user-supplied).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="73" y="1721" width="210" height="89" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-44" value="cell_annotation_diagnostic_plots&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Various diagnostic plots (heatmaps, scores etc.) for cell annotation results.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="328" y="1210" width="182" height="78.5" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-47" value="dimred_plots_clustering&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Plots of reduced dimensions colored by cluster labels.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="340" y="1649" width="168" height="50" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-48" value="dimred_plots_other_vars&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Plots of reduced dimensions colored by various cell variables (total UMI, # detected genes, cell cycle phase etc.) + user selection.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="340" y="1710" width="168" height="100" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-51" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;rotation=-90;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="270.05" y="1609.45" width="31.25" height="465.37" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-52" value="report_norm_clustering&lt;font color=&quot;#000000&quot;&gt; (file)&lt;br&gt;Full HTML report for this stage.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=#FFE5F3;" parent="1" vertex="1">
          <mxGeometry x="78" y="1880" width="175.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-53" value="report_norm_clustering_simple&lt;font color=&quot;#000000&quot;&gt; (file)&lt;br&gt;Simplified HTML report for this stage. Includes only dimred and&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;cell annotation&amp;nbsp;&lt;/span&gt;&lt;font color=&quot;#000000&quot;&gt;plots.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=#FFE5F3;" parent="1" vertex="1">
          <mxGeometry x="308" y="1870" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-54" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;strokeWidth=1;exitX=0.1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="OYucTifmdRN6tnTj4TT2-51" target="OYucTifmdRN6tnTj4TT2-52" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="418" y="1920" as="sourcePoint" />
            <mxPoint x="468" y="1870" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-56" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;strokeWidth=1;exitX=0.1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="OYucTifmdRN6tnTj4TT2-51" target="OYucTifmdRN6tnTj4TT2-53" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="418" y="1920" as="sourcePoint" />
            <mxPoint x="468" y="1870" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-57" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Stage 01_integration&lt;/b&gt;&lt;br&gt;integration, dimensionality reduction&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#C7F4FF;strokeColor=#66E0FF;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="590" y="120" width="470" height="870" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-58" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 24px;&quot;&gt;Integration pipeline&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#6666FF;fontSize=24;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="590" y="80.6" width="470" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-59" value="&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;Input data: multiple&amp;nbsp;&lt;/span&gt;&lt;font style=&quot;background-color: initial;&quot; color=&quot;#6666ff&quot;&gt;sce_final_norm_clustering&lt;/font&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;targets (SCE) from the single-sample pipeline runs. Loaded either from drake caches or as Rds files (with e.g. additional cell data).&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=default;fillColor=#E6E6E6;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;spacingLeft=4;spacingRight=4;" parent="1" vertex="1">
          <mxGeometry x="700" y="189.06" width="340" height="50.94" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-60" value="" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;strokeWidth=1;align=center;outlineConnect=0;dashed=0;outlineConnect=0;shape=mxgraph.aws3d.file;aspect=fixed;strokeColor=#292929;" parent="1" vertex="1">
          <mxGeometry x="640" y="170.00000000000003" width="40" height="91.68" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-61" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.152;entryY=-0.007;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" target="OYucTifmdRN6tnTj4TT2-62" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="651" y="245" as="sourcePoint" />
            <mxPoint x="650" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-69" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=1;fontColor=#000000;endArrow=classic;endFill=1;dashed=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-62" target="OYucTifmdRN6tnTj4TT2-63" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-62" value="sce_int_import&lt;font color=&quot;#000000&quot;&gt; (list)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;A list of SCE objects to be integrated.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="620" y="285" width="210" height="35" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-70" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;fontColor=#000000;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-63" target="OYucTifmdRN6tnTj4TT2-66" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-63" value="sce_int_multibatchnorm&lt;font color=&quot;#000000&quot;&gt; (list)&lt;br&gt;A list of SCE objects normalized for inter-batch sequencing depth (&lt;i&gt;batchelor::multiBatchNorm()&lt;/i&gt;). This method is later denoted as &quot;uncorrected&quot; and further used for cluster markers detection.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="620" y="351" width="210" height="110" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-74" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;fontColor=#000000;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-66" target="OYucTifmdRN6tnTj4TT2-67" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-66" value="sce_int_df&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;A dataframe of integrated SCE objects by selected methods. Prior selection of HVGs, optionally performed after prior removal of cell cycle-related genes.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=4;" parent="1" vertex="1">
          <mxGeometry x="620" y="492" width="210" height="98" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-110" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.25;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;fontSize=20;fontColor=#000000;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-67" target="OYucTifmdRN6tnTj4TT2-76" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="600" y="658" />
              <mxPoint x="600" y="804" />
              <mxPoint x="620" y="804" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="_7ywalsgCx7BF0AgiLHg-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-67" target="OYucTifmdRN6tnTj4TT2-71" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-67" value="sce_int_pca_df&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;Computed PCA and selected number of PCs (each integration method can have a different selection strategy).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="620" y="618" width="210" height="75" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-68" value="int_diagnostics_df&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;Various integration diagnostics (tables, plots).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="862" y="680" width="178" height="55" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-73" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;fontColor=#000000;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-71" target="OYucTifmdRN6tnTj4TT2-68" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-71" value="sce_int_clustering_df&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;Computed graph-based clustering for integration diagnostics.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="620" y="721.63" width="210" height="48.37" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-82" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;fontColor=#000000;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-76" target="OYucTifmdRN6tnTj4TT2-81" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-111" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeWidth=1;fontSize=20;fontColor=#000000;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-76" target="OYucTifmdRN6tnTj4TT2-77" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;strokeWidth=2;" parent="1" source="OYucTifmdRN6tnTj4TT2-76" target="OYucTifmdRN6tnTj4TT2-90" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="600" y="820" />
              <mxPoint x="600" y="1138" />
              <mxPoint x="617" y="1138" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-76" value="sce_int_dimred_df&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;Computed dimreds (UMAP, tSNE).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="620" y="795" width="210" height="35" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-77" value="sce_int_dimred_plots_df&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;Dimred plots of each integrated dataset colored by dataset of origin (batch) and cell cycle phase.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="620" y="855" width="210" height="65" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-78" value="selected_markers_plots&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Dimred plots colored by expression of selected markers loaded from a user supplied file (optional).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="344" y="1542.63" width="160" height="82" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-81" value="selected_markers_int_plots_df&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Dimred plots colored by expression of selected markers loaded from a user supplied file (optional).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="862" y="763.13" width="178" height="98.75" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-83" value="report_integration&lt;font color=&quot;#000000&quot;&gt; (file)&lt;br&gt;HTML report for this stage.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=#FFE5F3;" parent="1" vertex="1">
          <mxGeometry x="751.72" y="945" width="158" height="40" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-86" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;fillColor=#FFE5F3;rotation=-90;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="816.08" y="711.94" width="29.28" height="436.85" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-89" value="&lt;div style=&quot;&quot;&gt;Based on the configuration, the following integration methods are performed:&lt;/div&gt;&lt;div style=&quot;&quot;&gt;-&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;Rescaling (&lt;i&gt;batchelor::rescaleBatches()&lt;/i&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;- Regression (&lt;i&gt;batchelor::regressBatches()&lt;/i&gt;)&lt;/div&gt;&lt;div&gt;- Fast mutual nearest neighbors (&lt;i&gt;batchelor::fastMNN()&lt;/i&gt;)&lt;/div&gt;&lt;div&gt;- Harmony&lt;br&gt;&lt;/div&gt;&lt;div&gt;(harmony::RunHarmony())&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If requested, each method is also performed additionally for dataset with removed cell cycle-related genes from HVGs.&lt;/div&gt;" style="text;html=1;strokeColor=default;fillColor=#E6E6E6;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;spacingLeft=4;" parent="1" vertex="1">
          <mxGeometry x="862" y="380" width="178" height="247.5" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-90" target="OYucTifmdRN6tnTj4TT2-93" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-90" target="OYucTifmdRN6tnTj4TT2-91" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="810" y="1138" />
              <mxPoint x="810" y="1224" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-90" value="sce_int_final&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;A final integrated SCE object. The integration method and whether the dataset has removed cell-cycle related genes from HVGs is upon the user preference.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=2;spacingBottom=0;spacingRight=2;" parent="1" vertex="1">
          <mxGeometry x="617.5" y="1085" width="185" height="105" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-91" target="OYucTifmdRN6tnTj4TT2-92" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-91" value="cell_annotation&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Cell annotation statistics using defined reference datasets (optional).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=2;spacingRight=2;" parent="1" vertex="1">
          <mxGeometry x="823.25" y="1194" width="208" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-92" value="cell_annotation_diagnostic_plots&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Various diagnostic plots (heatmaps, scores etc.) for cell annotation results.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=2;spacingRight=2;" parent="1" vertex="1">
          <mxGeometry x="823.25" y="1280.5" width="208" height="80" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-93" target="OYucTifmdRN6tnTj4TT2-100" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-93" target="OYucTifmdRN6tnTj4TT2-99" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="810" y="1282" />
              <mxPoint x="810" y="1420" />
              <mxPoint x="823" y="1420" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-93" value="sce_int_final_clustering&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;The final SCE object of this stage. Contains: reduced dimensions, cell clusters (graph-based, k-means, SC3), cell annotation (optional), all other cell data (including user-supplied).&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=2;spacingRight=2;" parent="1" vertex="1">
          <mxGeometry x="617.5" y="1221" width="185" height="122" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-99" value="dimred_plots_clustering&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Plots of reduced dimensions colored by cluster labels.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="823.25" y="1395.88" width="208" height="50" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-100" value="dimred_plots_other_vars&lt;font color=&quot;#000000&quot;&gt; (df)&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;Plots of reduced dimensions colored by various cell variables (total UMI, # detected genes, cell cycle phase etc.) + user selection.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;spacingLeft=2;spacingRight=2;" parent="1" vertex="1">
          <mxGeometry x="617.5" y="1373.75" width="185" height="94.25" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-104" value="&lt;div style=&quot;&quot;&gt;This stage is similar to 02_norm_clustering stage in the single-sample pipeline, except only cell clustering, cell annotation and visualization is performed here.&lt;/div&gt;" style="text;html=1;strokeColor=default;fillColor=#E6E6E6;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;spacingLeft=4;" parent="1" vertex="1">
          <mxGeometry x="823.25" y="1085" width="208" height="85" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-105" value="report_int_clustering&lt;font color=&quot;#000000&quot;&gt; (file)&lt;br&gt;HTML report for this stage.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=#FFE5F3;" parent="1" vertex="1">
          <mxGeometry x="747.3" y="1542.63" width="158" height="40" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-106" target="OYucTifmdRN6tnTj4TT2-105" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-106" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;fillColor=#FFE5F3;rotation=-90;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="808.8" y="1288.71" width="35" height="420" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-108" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Stage cluster_markers&lt;/b&gt;&lt;br&gt;identify global cluster marker genes, i.e. genes that drive the separation of each cell cluster&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFD1F0;strokeColor=#FF52C5;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="1120" y="120" width="455" height="450" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-109" value="&lt;font color=&quot;#000000&quot; style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 24px;&quot;&gt;Common pipelines&lt;/font&gt;&lt;br style=&quot;font-size: 24px;&quot;&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#6666FF;fontSize=24;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="1122.5" y="64" width="450" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-117" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeWidth=2;fontSize=20;fontColor=#6666FF;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-113" target="OYucTifmdRN6tnTj4TT2-115" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-113" value="sce_cluster_markers&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;/font&gt;&lt;br&gt;sce_rm_doublets&lt;font color=&quot;#000000&quot;&gt; for the single-sample pipeline, &lt;/font&gt;sce_int_final_clustering&lt;font color=&quot;#000000&quot;&gt; for the integration pipeline.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="1140" y="189.06" width="220" height="60.94" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-114" value="&lt;div style=&quot;&quot;&gt;The user can define in which categorical variables (clusters, CC phases etc.) to search for markers. For each variable,&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;three different tests (Student&#39;s t, Wilcoxon, binomial) are calculated&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;for each pairwise comparison of the variable levels. For example, for k-means clustering with k = 3 we have three pairwise comparisons (1 vs. 2, 1 vs. 3, 2 vs. 3) and three different tests for each of them.&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=default;fillColor=#E6E6E6;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;spacingLeft=4;" parent="1" vertex="1">
          <mxGeometry x="1380" y="189.06" width="180" height="215" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-118" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeWidth=2;fontSize=20;fontColor=#6666FF;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-115" target="OYucTifmdRN6tnTj4TT2-116" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-115" value="cluster_markers_raw&lt;font color=&quot;#000000&quot;&gt; (df)&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#000000&quot;&gt;Cluster marker statistics as returned from &lt;i&gt;scran::findMarkers()&lt;/i&gt;.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="1140" y="281.29999999999995" width="220" height="49.7" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-116" value="cluster_markers_out&lt;font color=&quot;#000000&quot;&gt; (df)&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#000000&quot;&gt;Polished cluster marker tables.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="1140" y="364.06" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-119" value="report_cluster_markers&lt;font color=&quot;#000000&quot;&gt; (file)&lt;br&gt;HTML report for this stage.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=#FFE5F3;" parent="1" vertex="1">
          <mxGeometry x="1171" y="485" width="158" height="40" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-122" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeWidth=2;fontSize=20;fontColor=#6666FF;endArrow=classic;endFill=1;" parent="1" source="OYucTifmdRN6tnTj4TT2-120" target="OYucTifmdRN6tnTj4TT2-119" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-120" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;fillColor=#FFE5F3;rotation=-90;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="1235.61" y="315" width="28.79" height="235.59" as="geometry" />
        </mxCell>
        <mxCell id="OYucTifmdRN6tnTj4TT2-123" value="&lt;div style=&quot;&quot;&gt;While not shown, &lt;font color=&quot;#6666ff&quot;&gt;report_cluster_markers&lt;/font&gt; also depends on many other targets. For each pairwise test, there is a HTML table with marker statistics, and a heatmap of top N markers.&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;Also,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;a summary plot is generated&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&amp;nbsp;for each of top N markers.&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=default;fillColor=#E6E6E6;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;spacingLeft=4;" parent="1" vertex="1">
          <mxGeometry x="1380" y="420" width="180" height="140" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-1" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Stage contrasts&lt;/b&gt;&lt;br&gt;differential gene expression between cell clusters&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFD1F0;strokeColor=#FF52C5;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="1120" y="610" width="455" height="303.5" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeWidth=2;fontSize=20;fontColor=#6666FF;endArrow=classic;endFill=1;" parent="1" source="DrTMwaxAC77EiMDbTJBz-4" target="DrTMwaxAC77EiMDbTJBz-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-4" value="sce_contrasts&lt;font color=&quot;#000000&quot;&gt; (SCE)&lt;/font&gt;&lt;br&gt;sce_rm_doublets&lt;font color=&quot;#000000&quot;&gt; for the single-sample pipeline, &lt;/font&gt;sce_int_final_clustering&lt;font color=&quot;#000000&quot;&gt; for the integration pipeline.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="1140" y="679.06" width="220" height="60.94" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-5" value="&lt;div style=&quot;&quot;&gt;The contrasts stage is very similar to the cluster_markers stage, except all outputs (heatmaps, tables) are related to individual pairwise comparisons.&lt;/div&gt;" style="text;html=1;strokeColor=default;fillColor=#E6E6E6;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;spacingLeft=4;" parent="1" vertex="1">
          <mxGeometry x="1380" y="679.06" width="180" height="84.44" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeWidth=2;fontSize=20;fontColor=#6666FF;endArrow=classic;endFill=1;" parent="1" source="DrTMwaxAC77EiMDbTJBz-7" target="DrTMwaxAC77EiMDbTJBz-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-7" value="contrasts_raw&lt;font color=&quot;#000000&quot;&gt; (df)&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#000000&quot;&gt;Differential expression (DE) statistics as returned from &lt;i&gt;scran::findMarkers()&lt;/i&gt;.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="1140" y="771.3" width="220" height="49.7" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-8" value="contrasts_out&lt;font color=&quot;#000000&quot;&gt; (df)&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#000000&quot;&gt;Polished DE tables.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=default;" parent="1" vertex="1">
          <mxGeometry x="1140" y="854.06" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-9" value="report_contrasts&lt;font color=&quot;#000000&quot;&gt; (file)&lt;br&gt;HTML report for this stage.&lt;br&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontColor=#6666FF;fillColor=#FFE5F3;" parent="1" vertex="1">
          <mxGeometry x="1402" y="808.8300000000002" width="158" height="40" as="geometry" />
        </mxCell>
        <mxCell id="DrTMwaxAC77EiMDbTJBz-11" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;fillColor=#FFE5F3;rotation=-180;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="1370" y="773.5" width="28.79" height="115" as="geometry" />
        </mxCell>
        <mxCell id="V3Z19Sr7CIbmZhE3F0cb-1" value="&lt;span style=&quot;color: rgb(0, 0, 0); font-family: Helvetica; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(248, 249, 250); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;stages common to both single-sample and integration pipelines&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;fontSize=16;align=center;" parent="1" vertex="1">
          <mxGeometry x="1117.5" y="86.6" width="460" height="40" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
