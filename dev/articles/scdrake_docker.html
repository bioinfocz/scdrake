<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="scdrake">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/5/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Using the Docker image • scdrake</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using the Docker image">
<meta property="og:description" content="scdrake">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=281550496"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '281550496');
</script><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/5/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/5/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="../preferably.css">
<link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
<script src="../darkswitch.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scdrake</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.5.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/scdrake.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/scdrake_integration.html">Integration pipeline guide</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pipeline_overview.html">Pipeline overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/scdrake_faq.html">FAQ &amp; Howtos</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Guides</h6>
    <a class="dropdown-item" href="../articles/scdrake_docker.html">Using the Docker image</a>
    <a class="dropdown-item" href="../articles/scdrake_integration.html">02 Integration pipeline guide</a>
    <a class="dropdown-item" href="../articles/scdrake_advanced.html">Advanced topics</a>
    <a class="dropdown-item" href="../articles/scdrake_extend.html">Extending the pipeline</a>
    <a class="dropdown-item" href="../articles/drake_basics.html">drake basics</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>General information</h6>
    <a class="dropdown-item" href="../articles/pipeline_overview.html">Pipeline overview</a>
    <a class="dropdown-item" href="../articles/scdrake_faq.html">FAQ &amp; Howtos</a>
    <a class="dropdown-item" href="../articles/scdrake_cli.html">Command line interface</a>
    <a class="dropdown-item" href="../articles/scdrake_config.html">scdrake config internals</a>
    <a class="dropdown-item" href="../articles/scdrake_envvars.html">Environment variables</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>General configs</h6>
    <a class="dropdown-item" href="../articles/config_pipeline.html">Pipeline config</a>
    <a class="dropdown-item" href="../articles/config_main.html">Main config</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Single-sample pipeline stages</h6>
    <a class="dropdown-item" href="../articles/stage_input_qc.html">Input and quality control stage (`01_input_qc`)</a>
    <a class="dropdown-item" href="../articles/stage_norm_clustering.html">Normalization and clustering stage (`02_norm_clustering`)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Integration pipeline stages</h6>
    <a class="dropdown-item" href="../articles/stage_integration.html">Integration stage (`01_integration`)</a>
    <a class="dropdown-item" href="../articles/stage_int_clustering.html">Post-integration clustering stage (`02_int_clustering`)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Common stages</h6>
    <a class="dropdown-item" href="../articles/stage_cluster_markers.html">Cluster markers stage (`cluster_markers`)</a>
    <a class="dropdown-item" href="../articles/stage_contrasts.html">Contrasts stage (`contrasts`)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bioinfocz/scdrake" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>

        
        <li>
          <a class="external-link nav-link" id="css-toggle-btn" aria-label="github">
            <span class="fas fa fas fa-adjust fa-lg"></span>
          </a>
        </li>
        
        
        
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Using the Docker image</h1>
            
            <h4 data-toc-skip class="date"><sup>Document generated:
2023-12-04 17:23:50 UTC+0000</sup></h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bioinfocz/scdrake/blob/mastervignettes/scdrake_docker.Rmd" class="external-link"><code>vignettes/scdrake_docker.Rmd</code></a></small>
      <div class="d-none name"><code>scdrake_docker.Rmd</code></div>
    </div>

    
    
<hr>
<p><a href="https://www.docker.com/" class="external-link">Docker</a> (<a href="https://en.wikipedia.org/wiki/Docker_(software)" class="external-link">wiki</a>) is a
software for running isolated <em>containers</em> which are based on
<em>images</em>. You can think of them as small, isolated operating
systems.</p>
<p>The <a href="https://bioconductor.org/help/docker/" class="external-link">Bioconductor’s
page for Docker</a> provides itself a nice introduction to Docker and
its usage for R, and we recommend to read it through. In this vignette,
we will mainly give practical examples related to
<a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a>.</p>
<p>You can also run the image in <a href="https://docs.sylabs.io/guides/latest/user-guide/quick_start.html" class="external-link">SingularityCE</a>
(without RStudio) - see <a href="#singularity">Singularity</a>
below.</p>
<div class="section level2">
<h2 id="platform-specific-notes">Platform-specific notes<a class="anchor" aria-label="anchor" href="#platform-specific-notes"></a>
</h2>
<div class="section level3">
<h3 id="linux-hosts-important">Linux hosts (<em>important</em>)<a class="anchor" aria-label="anchor" href="#linux-hosts-important"></a>
</h3>
<p>On a Linux host, there can be different Docker distributions
installed:</p>
<ul>
<li>
<a href="https://docs.docker.com/desktop/" class="external-link">Docker Desktop</a> (DD)
<ul>
<li>DD is a more sophisticated suite which runs a Linux virtual machine
in which DE is run. DD can be used on Linux hosts, but it is required
for Mac and Windows ones. However, on Linux, DD has some differences, of
which the one that most affects <a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a>’s ease of use is
file sharing (will be discussed later).</li>
</ul>
</li>
<li>
<a href="https://docs.docker.com/engine/" class="external-link">Docker Engine</a> (DE).
<ul>
<li>DE is the core of Docker that manages containers. It can be used
natively on Linux hosts.</li>
</ul>
</li>
</ul>
<p>If you are using a Linux host to run the <a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a>
image, we <strong>recommend</strong> to stick with Docker Engine (see
the <a href="https://docs.docker.com/desktop/faqs/linuxfaqs/" class="external-link">official
FAQ</a> on DD and Linux).</p>
<p><strong>See <a href="https://docs.docker.com/desktop/faqs/linuxfaqs/#context" class="external-link">here</a>
how to quickly switch to DE if you have installed DD.</strong></p>
<p>Otherwise in Docker Desktop:</p>
<ul>
<li>You won’t be able to run RStudio Server due to problems with file
ownership.</li>
<li>To sustain the file ownership in the shared directory, you have to
execute commands in the container as root. That means you have to omit
the <code>-u rstudio</code> parameter or use <code>-u root</code>. For
more details see the note in <a href="#problems-with-filesystem-permissions">Problems with filesystem
permissions</a> below.</li>
</ul>
</div>
<div class="section level3">
<h3 id="windows">Windows<a class="anchor" aria-label="anchor" href="#windows"></a>
</h3>
<p>We recommend to use <a href="https://learn.microsoft.com/en-us/windows/wsl/about" class="external-link">WSL2</a> and
its <a href="https://ubuntu.com/tutorials/install-ubuntu-on-wsl2-on-windows-10#1-overview" class="external-link">Ubuntu
distribution</a> for Docker Desktop (<a href="https://docs.docker.com/desktop/windows/wsl/" class="external-link">guide</a>) as this
is successfully tested by us.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="cheatsheet">Cheatsheet<a class="anchor" aria-label="anchor" href="#cheatsheet"></a>
</h2>
<p>A quick summary of the more detailed steps below. Note that this is
not covering a special case of a Linux host using Docker Desktop.</p>
<details><summary>
Click to show the cheatsheet
</summary><div class="section level3">
<h3 id="get-the-scdrake-image">Get the <code>scdrake</code> image<a class="anchor" aria-label="anchor" href="#get-the-scdrake-image"></a>
</h3>
<div class="section level4">
<h4 id="linux-windows-and-amd64-mac">Linux, Windows, and amd64 Mac<a class="anchor" aria-label="anchor" href="#linux-windows-and-amd64-mac"></a>
</h4>
<p>Latest stable version:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> pull jirinovo/scdrake:1.5.1</span></code></pre></div>
<p>Latest development version:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> pull jirinovo/scdrake:latest</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="create-a-shared-directory">Create a shared directory<a class="anchor" aria-label="anchor" href="#create-a-shared-directory"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> ~/scdrake_projects</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/scdrake_projects</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-the-image">Run the image<a class="anchor" aria-label="anchor" href="#run-the-image"></a>
</h3>
<p>For Linux (using Docker Engine), Mac and Windows.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="dt">\</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-v</span> <span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span>:/home/rstudio/scdrake_projects <span class="dt">\</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-p</span> 8787:8787 <span class="dt">\</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-e</span> USERID=<span class="va">$(</span><span class="fu">id</span> <span class="at">-u</span><span class="va">)</span> <span class="dt">\</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">-e</span> GROUPID=<span class="va">$(</span><span class="fu">id</span> <span class="at">-g</span><span class="va">)</span> <span class="dt">\</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">-e</span> PASSWORD=1234 <span class="dt">\</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  jirinovo/scdrake:1.5.1</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="find-the-id-or-name-of-the-running-container">Find the ID or name of the running container<a class="anchor" aria-label="anchor" href="#find-the-id-or-name-of-the-running-container"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> ps</span></code></pre></div>
<pre><code>CONTAINER ID   IMAGE                            COMMAND   CREATED        STATUS        PORTS                                       NAMES
d47b4d265052   scdrake:1.4.0-bioc3.15           "/init"   24 hours ago   Up 24 hours   0.0.0.0:8787-&gt;8787/tcp, :::8787-&gt;8787/tcp   condescending_payne</code></pre>
</div>
<div class="section level3">
<h3 id="run-scdrake-through-its-cli">Run <code>scdrake</code> through its CLI<a class="anchor" aria-label="anchor" href="#run-scdrake-through-its-cli"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> exec <span class="at">-it</span> <span class="at">-u</span> rstudio <span class="at">-w</span> /home/rstudio/scdrake_projects <span class="op">&lt;</span>CONTAINER ID or NAME<span class="op">&gt;</span> <span class="dt">\</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  scdrake <span class="at">-h</span></span></code></pre></div>

<hr>
</div>
</details>
</div>
<div class="section level2">
<h2 id="obtaining-the-docker-image">Obtaining the Docker image<a class="anchor" aria-label="anchor" href="#obtaining-the-docker-image"></a>
</h2>
<p>A Docker image based on the <a href="https://bioconductor.org/help/docker/" class="external-link">official Bioconductor
image</a> (version 3.15) is available. This is the most handy and
reproducible way how to use <a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a> as all the
dependencies are already installed and their version is fixed. In
addition, the parent Bioconductor image comes bundled with RStudio
Server.</p>
<p>You can pull the Docker image with the latest stable
<a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a> version using</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> pull jirinovo/scdrake:1.5.1</span></code></pre></div>
<p>or list available versions in <a href="https://hub.docker.com/r/jirinovo/scdrake/tags" class="external-link">our Docker Hub
repository</a>.</p>
<p>For the latest development version use</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> pull jirinovo/scdrake:latest</span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="running-the-image">Running the image<a class="anchor" aria-label="anchor" href="#running-the-image"></a>
</h2>
<p>The <a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a>’s image is based on the <a href="https://bioconductor.org/help/docker/" class="external-link">Bioconductor’s image</a>
which is in turn based on the <a href="https://rocker-project.org/images/versioned/rstudio.html" class="external-link">Rocker
Project’s</a> image (<code>rocker/rstudio</code>). Thanks to it, the
<a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a>’s image comes bundled with RStudio Server.</p>
<p>Docker allows to mount local (host) directories to containers. We
recommend to create a local directory in which individual
<a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a> projects (and other files, if needed) will lie.
This way you won’t lose data when a container is destroyed. Let’s create
such shared directory in your home directory and switch to it:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> ~/scdrake_projects</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/scdrake_projects</span></code></pre></div>
<div class="section level3">
<h3 id="running-detached-with-rstudio-server">Running detached with RStudio Server<a class="anchor" aria-label="anchor" href="#running-detached-with-rstudio-server"></a>
</h3>
<p><strong>Important</strong>: not working on Linux hosts using Docker
Desktop.</p>
<p><a href="https://posit.co/products/open-source/rstudio-server/" class="external-link">RStudio
Server</a> is a comfortable IDE for R. You can run the image including
an RStudio instance using:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="dt">\</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-v</span> <span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span>:/home/rstudio/scdrake_projects <span class="dt">\</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-p</span> 8787:8787 <span class="dt">\</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-e</span> USERID=<span class="va">$(</span><span class="fu">id</span> <span class="at">-u</span><span class="va">)</span> <span class="dt">\</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">-e</span> GROUPID=<span class="va">$(</span><span class="fu">id</span> <span class="at">-g</span><span class="va">)</span> <span class="dt">\</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">-e</span> PASSWORD=1234 <span class="dt">\</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  jirinovo/scdrake:1.5.1</span></code></pre></div>
<p>Let’s decompose the command above:</p>
<ul>
<li>
<code>docker run</code>: run image as a container.</li>
<li>
<code>-d</code>: run in detached (“background”) mode.</li>
<li>
<code>-v $(pwd):/home/rstudio/scdrake_projects</code>: mount the
current working directory on the host machine as
<code>/home/rstudio/scdrake_projects</code> inside the container.</li>
<li>
<code>-p 8787:8787</code>: expose port <code>8787</code> in
container as port <code>8787</code> on localhost.</li>
<li>
<code>-e USERID=$(id -u) -e GROUPID=$(id -g)</code>: change
ownership of <code>/home/rstudio</code> in the container to the ID and
group ID of the current host user. This is important as it sustains the
correct file ownership, i.e. when you write to
<code>/home/rstudio/scdrake_projects</code> from within the container,
you actually write to the host filesystem and you do so as the proper
user/group.</li>
<li>
<code>-e PASSWORD=1234</code>: password for RStudio Server (and the
username is <code>rstudio</code>).</li>
<li>
<code>jirinovo/scdrake:&lt;tag&gt;</code>: repository and tag of the
image to be run.</li>
</ul>
<p>The <code>-e VAR=VALUE</code> arguments are used to set environment
variables inside the container. You can check those for the parent
<code>rocker/rstudio</code> image <a href="https://rocker-project.org/images/versioned/rstudio.html#environment-variables" class="external-link">here</a>.</p>
<p>An image can have a default command which is executed on container
run. For our image, it’s a script <code>/init</code> which starts
RStudio Server.</p>
<p>Now you can check that the container is running:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> ps</span></code></pre></div>
<p>You should see something as</p>
<pre><code>CONTAINER ID   IMAGE                            COMMAND   CREATED        STATUS        PORTS                                       NAMES
d47b4d265052   scdrake:1.4.0-bioc3.15           "/init"   24 hours ago   Up 24 hours   0.0.0.0:8787-&gt;8787/tcp, :::8787-&gt;8787/tcp   condescending_payne</code></pre>
<p>Values in the <code>CONTAINER ID</code> and <code>NAMES</code>
columns can be then used to reference the running container.</p>
<p>You can see that we have exposed port <code>8787</code>. What it is
useful for? Well, it allows us to connect to RStudio Server instance,
which is running on port 8787 inside the container. Now you can just
open your browser, navigate to <code>localhost:8787</code> and login as
<code>rstudio</code> with password <code>1234</code>.</p>
<p>TIP: if you are using a remote server which you can SSH into and it
allows SSH tunneling, then you can forward the exposed port to your
host:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> <span class="at">-NL</span> 8787:localhost:8787 user@server</span></code></pre></div>
<p>Now you can start using <a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a> from the RStudio, or
read below for alternative ways.</p>
</div>
<div class="section level3">
<h3 id="running-detached-without-rstudio-server">Running detached without RStudio Server<a class="anchor" aria-label="anchor" href="#running-detached-without-rstudio-server"></a>
</h3>
<p>If you just want to run the image detached without RStudio Server,
use</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="dt">\</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-u</span> rstudio <span class="dt">\</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-v</span> <span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span>:/home/rstudio/scdrake_projects <span class="dt">\</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  jirinovo/scdrake:1.5.1 <span class="dt">\</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  sleep infinity</span></code></pre></div>
<p>Note for Docker Desktop on a Linux host: omit the
<code>-u rstudio</code> (or use <code>-u root</code>) to run the image
as root. This will mount <code>/home/rstudio/scdrake_projects</code> as
UID 0 in the container, but UID of the DD user will be used in the host
directory.</p>
</div>
<div class="section level3">
<h3 id="running-once-run-and-forget">Running once (“run and forget”)<a class="anchor" aria-label="anchor" href="#running-once-run-and-forget"></a>
</h3>
<p>Running the image in detached mode gives us chance e.g. to find out
more details about what’s wrong in a failed pipeline run, or to work
interactively in RStudio. However, we can also run the image in a “run
and forget” mode where a container is started, <a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a> is
run, and finally the container is stopped and removed.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-it</span> <span class="at">--rm</span> <span class="dt">\</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-v</span> <span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span>:/home/rstudio/scdrake_projects <span class="dt">\</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  jirinovo/scdrake:1.5.1 <span class="dt">\</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  scdrake ...</span></code></pre></div>
<p>Note for Linux hosts using Docker Engine: the active user in the
container will be root and created files will belong to him. If your
user ID (UID) on the host is 1000, you can use the
<code>-u rstudio</code>, and created files will then belong to you. If
your UID is different, then either run the image including RStudio or
refer to <a href="#problems-with-filesystem-permissions">Problems with
filesystem permissions</a> below.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="issuing-commands-in-the-running-container">Issuing commands in the running container<a class="anchor" aria-label="anchor" href="#issuing-commands-in-the-running-container"></a>
</h2>
<p>You can start <code>bash</code> or <code>R</code> process inside the
container and attach to it using</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> exec <span class="at">-it</span> <span class="at">-u</span> rstudio <span class="op">&lt;</span>CONTAINER ID or NAME<span class="op">&gt;</span> bash</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> exec <span class="at">-it</span> <span class="at">-u</span> rstudio <span class="op">&lt;</span>CONTAINER ID or NAME<span class="op">&gt;</span> R</span></code></pre></div>
<ul>
<li>
<code>docker exec</code>: executes a command in a
<strong>running</strong> container.</li>
<li>
<code>-i</code>: interactive.</li>
<li>
<code>-t</code>: allocate a pseudo-TTY.</li>
</ul>
<p>Note for Docker Desktop on a Linux host: omit the
<code>-u rstudio</code> (or use <code>-u root</code>).</p>
<hr>
</div>
<div class="section level2">
<h2 class="tabset" id="problems-with-filesystem-permissions">Problems with filesystem permissions<a class="anchor" aria-label="anchor" href="#problems-with-filesystem-permissions"></a>
</h2>
<p>In the first example, when we run the image including RStudio Server,
we specified <code>-e USERID=$(id -u) -e GROUPID=$(id -g)</code>, and so
ownership of <code>/home/rstudio</code> was changed to match the host
user*. Then when you write to the shared directory
<code>/home/rstudio/scdrake_projects</code>, you are basically doing
that as the host user.</p>
<p><em><sup>* This is actually not a feature of Docker, but the
<code>rocker/rstudio</code> image which uses those environment variables
to run the <code>/rocker_scripts/init_userconf.sh</code> which manages
the ownership.</sup></em></p>
<p>By default, <code>rstudio</code> user in the container has ID of 1000
which is commonly used for the default user in most Linux distributions.
You can check it yourself on your host by executing <code>id -u</code>.
If it is 1000, then you can safely skip the instructions below.</p>
<p>Note for Linux hosts using Docker Desktop: in this case, Docker
manages the file ownership as described <a href="https://docs.docker.com/desktop/faqs/linuxfaqs/#how-do-i-enable-file-sharing" class="external-link">here</a>.
For you it means the root user (UID 0) inside the container will write
to the shared directory using UID of the Docker Desktop user, so you
don’t have to care about the <code>-u rstudio</code> parameter in
<code>docker exec</code> command.</p>
<hr>
<p>So when you don’t want to run RStudio Server and your host user ID is
not 1000, you have to take care of ownership by yourself. There are
several ways how to accomplish that. You can also read about this
problem <a href="https://www.fullstaq.com/knowledge-hub/blogs/docker-and-the-host-filesystem-owner-matching-problem" class="external-link">here</a>
or <a href="https://vsupalov.com/docker-shared-permissions/" class="external-link">here</a>.</p>
<div class="section level3">
<h3 id="modify-the-user-and-group-id-in-the-container">Modify the user and group ID in the container<a class="anchor" aria-label="anchor" href="#modify-the-user-and-group-id-in-the-container"></a>
</h3>
<p>The <code>rocker/rstudio</code> parent image already comes with a
script which can add or modify user information (it is actually run when
you start the container including RStudio Server).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> exec <span class="dt">\</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-e</span> USERID=<span class="va">$(</span><span class="fu">id</span> <span class="at">-u</span><span class="va">)</span> <span class="at">-e</span> GROUPID=<span class="va">$(</span><span class="fu">id</span> <span class="at">-g</span><span class="va">)</span> <span class="dt">\</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;</span>CONTAINER ID or NAME<span class="op">&gt;</span> <span class="dt">\</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  bash /rocker_scripts/init_userconf.sh</span></code></pre></div>
<p>Note that this just changes ID and group of the <code>rstudio</code>
user, so later don’t forget to run commands as this user,
i.e. <code>docker exec -u rstudio ...</code></p>
</div>
<div class="section level3">
<h3 id="chowning-tedious">“Chowning” (tedious)<a class="anchor" aria-label="anchor" href="#chowning-tedious"></a>
</h3>
<p>If you have root privileges on the host, you can just change
ownership each time you write to the shared directory from the
container:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> chown <span class="at">-R</span> <span class="va">$(</span><span class="fu">id</span> <span class="at">-u</span><span class="va">)</span>:<span class="va">$(</span><span class="fu">id</span> <span class="at">-g</span><span class="va">)</span> scdrake_projects</span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="issuing-scdrake-commands-through-its-command-line-interface-cli">Issuing <code>{scdrake}</code> commands through its command line
interface (CLI)<a class="anchor" aria-label="anchor" href="#issuing-scdrake-commands-through-its-command-line-interface-cli"></a>
</h2>
<p>We now assume that the <a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a> container is running
and the shared directory is mounted in
<code>/home/rstudio/scdrake_projects</code>. The <a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a>
commands can be easily issued through its CLI (see
<code><a href="../articles/scdrake_cli.html">vignette("scdrake_cli")</a></code>):</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> exec <span class="at">-it</span> <span class="at">-u</span> rstudio <span class="op">&lt;</span>CONTAINER ID or NAME<span class="op">&gt;</span> <span class="dt">\</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  scdrake <span class="at">-h</span></span></code></pre></div>
<p>The usual workflow can be similar to the following:</p>
<ol style="list-style-type: decimal">
<li>Initialize a new project:</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> exec <span class="at">-it</span> <span class="at">-u</span> rstudio <span class="at">-w</span> /home/rstudio/scdrake_projects <span class="op">&lt;</span>CONTAINER ID or NAME<span class="op">&gt;</span> <span class="dt">\</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  scdrake <span class="at">-d</span> my_first_project init-project</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Modify the configs on your host in
<code>my_first_project/config/</code></p></li>
<li><p>Run the pipeline:</p></li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> exec <span class="at">-it</span> <span class="at">-u</span> rstudio <span class="at">-w</span> /home/rstudio/scdrake_projects/my_first_project <span class="op">&lt;</span>CONTAINER ID or NAME<span class="op">&gt;</span> <span class="dt">\</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  scdrake <span class="at">--pipeline-type</span> single_sample run</span></code></pre></div>
<p>Note for Docker Desktop on a Linux host: omit the
<code>-u rstudio</code> (or use <code>-u root</code>).</p>
<hr>
</div>
<div class="section level2">
<h2 id="create-a-command-alias">Create a command alias<a class="anchor" aria-label="anchor" href="#create-a-command-alias"></a>
</h2>
<p>To reduce typing/copy-pasting a bit, you can create a command alias
in your shell, here for <code>bash</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> scdrake_docker=<span class="st">"docker exec -it -u rstudio &lt;CONTAINER ID or NAME&gt; scdrake"</span></span></code></pre></div>
<p>Note for Docker Desktop on a Linux host: omit the
<code>-u rstudio</code> (or use <code>-u root</code>).</p>
<p>And then use this alias as e.g.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">scdrake_docker</span> <span class="at">-d</span> /home/rstudio/scdrake_projects/my_first_project <span class="at">--pipeline-type</span> single_sample run</span></code></pre></div>
<p>Notice that we are using the <code>-d</code> parameter as the alias
doesn’t contain the <code>-w</code> parameter which instructs Docker to
execute the command in a working directory.</p>
<p>Finally, you can put the alias permanently inside your
<code>~/.bashrc</code> file. Just don’t forget to change
<code>&lt;CONTAINER ID or NAME&gt;</code> when you start a new container
:)</p>
<p>Alternatively, you can utilize the <a href="#running-interactively-run-and-forget">“run and forget” way</a>
described above:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> scdrake_docker=docker run <span class="at">-it</span> <span class="at">--rm</span> <span class="dt">\</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-v</span> <span class="va">$(</span><span class="fu">realpath</span> ~/scdrake_projects<span class="va">)</span>:/home/rstudio/scdrake_projects <span class="dt">\</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  jirinovo/scdrake:1.5.1 <span class="dt">\</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  scdrake</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="singularity">Singularity<a class="anchor" aria-label="anchor" href="#singularity"></a>
</h2>
<p>Singularity is an alternative container runner that does not require
root access, so it can be used on e.g. HPCs.</p>
<p>You will probably use Singularity in case you don’t have root
permissions on the host machine. It can be simply installed to the user
space e.g. via the <a href="https://docs.conda.io/en/latest/miniconda.html" class="external-link">conda</a> virtual
environment/package manager as the <a href="https://anaconda.org/conda-forge/singularity" class="external-link">conda-forge/singularity
package</a>.</p>
<p>Docker images can be simply pulled from the Docker Hub similar to
<code>docker pull</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">singularity</span> pull docker:jirinovo/scdrake:1.5.1</span></code></pre></div>
<p>The only difference is the usage of <code>docker:</code> prefix so
Singularity knows where to look for the image. If the image is already
present in the local Docker storage, you can use
<code>docker-daemon:</code> instead.</p>
<p>After pulling, Singularity needs to convert the image to the SIF
format, and that can take quite a time. By default, the SIF file is
saved in the current working directory.</p>
<div class="section level3">
<h3 id="running-the-image-in-singularity">Running the image in Singularity<a class="anchor" aria-label="anchor" href="#running-the-image-in-singularity"></a>
</h3>
<p>Here are some key differences compared to Docker:</p>
<ul>
<li>By default, Singularity issues commands in the container as the
current user. Thus, there are no problems with file ownership.</li>
<li>By default, Singularity mounts the host’s user <code>HOME</code> to
the container. While this might be practical in some cases, we rather
recommend to mount an empty/different directory to
<code>/home/&lt;user&gt;</code> in the container.</li>
<li>By default, Singularity containers are read only. Thus, you can only
write to mounted directories.</li>
<li>Although the image also contains RStudio, unfortunately, we were not
able to make it functional in Singularity.</li>
</ul>
<p>First we will create a directory structure. These directories will be
mounted to the container. Note that we also create a fake home directory
- that is because some R packages need to use a cache directory, which
is located there.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ~/scdrake_singularity</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/scdrake_singularity</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> home/<span class="va">${USER}</span> scdrake_projects/pbmc1k</span></code></pre></div>
<p>Now we can issue a <a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a> commands through its
CLI:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">singularity</span> exec <span class="dt">\</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">-e</span> <span class="dt">\</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--no-home</span> <span class="dt">\</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--bind</span> <span class="st">"home/</span><span class="va">${USER}</span><span class="st">/:/home/</span><span class="va">${USER}</span><span class="st">,scdrake_projects/:/home/</span><span class="va">${USER}</span><span class="st">/scdrake_projects"</span> <span class="dt">\</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">--pwd</span> <span class="st">"/home/</span><span class="va">${USER}</span><span class="st">/scdrake_projects"</span> <span class="dt">\</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    path/to/scdrake_image.sif <span class="dt">\</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    scdrake <span class="op">&lt;</span>args<span class="op">&gt;</span> <span class="op">&lt;</span>command<span class="op">&gt;</span></span></code></pre></div>
<p>For example, to initialize a new project:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="ex">singularity</span> exec <span class="dt">\</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">-e</span> <span class="dt">\</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--no-home</span> <span class="dt">\</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--bind</span> <span class="st">"home/</span><span class="va">${USER}</span><span class="st">/:/home/</span><span class="va">${USER}</span><span class="st">,scdrake_projects/:/home/</span><span class="va">${USER}</span><span class="st">/scdrake_projects"</span> <span class="dt">\</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">--pwd</span> <span class="st">"/home/</span><span class="va">${USER}</span><span class="st">/scdrake_projects/pbmc1k"</span> <span class="dt">\</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    path/to/scdrake_image.sif <span class="dt">\</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    scdrake <span class="at">--download-example-data</span> init-project</span></code></pre></div>
<p>And to run the pipeline using that project:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="ex">singularity</span> exec <span class="dt">\</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">-e</span> <span class="dt">\</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--no-home</span> <span class="dt">\</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--bind</span> <span class="st">"home/</span><span class="va">${USER}</span><span class="st">/:/home/</span><span class="va">${USER}</span><span class="st">,scdrake_projects/:/home/</span><span class="va">${USER}</span><span class="st">/scdrake_projects"</span> <span class="dt">\</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">--pwd</span> <span class="st">"/home/</span><span class="va">${USER}</span><span class="st">/scdrake_projects/pbmc1k"</span> <span class="dt">\</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    path/to/scdrake_image.sif <span class="dt">\</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    scdrake <span class="at">--pipeline-type</span> single_sample run</span></code></pre></div>
<p>Note that you can also start a bash or R session and use
<a href="https://github.com/bioinfocz/scdrake" class="external-link">scdrake</a> within that, e.g.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="ex">singularity</span> exec <span class="dt">\</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">-e</span> <span class="dt">\</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">--no-home</span> <span class="dt">\</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">--bind</span> <span class="st">"home/</span><span class="va">${USER}</span><span class="st">/:/home/</span><span class="va">${USER}</span><span class="st">,scdrake_projects/:/home/</span><span class="va">${USER}</span><span class="st">/scdrake_projects"</span> <span class="dt">\</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">--pwd</span> <span class="st">"/home/</span><span class="va">${USER}</span><span class="st">/scdrake_projects/pbmc1k"</span> <span class="dt">\</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    path/to/scdrake_image.sif <span class="dt">\</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    R</span></code></pre></div>
<p>and then in R</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">scdrake</span><span class="fu">::</span><span class="fu"><a href="../reference/run_pipeline.html">run_single_sample_r</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="copyright">
  <p></p>
<p>Developed by Jiri Novotny, Jan Kubovciak, Michal Kolar.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
